<div id="modal-backdrop" class="fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4 animate-fade-in">
    <div class="absolute inset-0" onclick="document.getElementById('modal-backdrop').remove()"></div>

    <div class="bg-white rounded-2xl shadow-2xl w-full max-w-md overflow-hidden relative z-10">

        <div class="bg-rose-600 p-4 text-white flex justify-between items-center">
            <h3 class="font-bold text-lg flex items-center gap-2">
                <i data-lucide="lock" class="w-5 h-5"></i> Fechamento de Caixa
            </h3>
            <button onclick="document.getElementById('modal-backdrop').remove()" class="btn btn-ghost btn-circle btn-sm text-white hover:bg-white/20">✕</button>
        </div>

        <form hx-post="{% url 'close_register_action' %}"
              hx-target="#booking-modal-container"
              hx-swap="innerHTML">

            <div class="p-6 space-y-4">
                {% if error %}
                <div class="alert alert-error text-white text-sm shadow-md">
                    <i data-lucide="alert-triangle" class="w-5 h-5"></i>
                    <span>{{ error }}</span>
                </div>
                {% endif %}

                <div class="text-center py-2 bg-gray-50 rounded-lg border border-gray-100">
                    <div class="text-xs text-gray-500 uppercase tracking-wider font-bold">Sessão Iniciada</div>
                    <div class="font-mono text-gray-800">{{ session.created_at|date:"d/m H:i" }}</div>
                </div>

                <div class="form-control">
                    <label class="label"><span class="label-text font-bold text-rose-600">Quanto tem na gaveta AGORA?</span></label>
                    <label class="input input-bordered input-error flex items-center gap-2 text-rose-600 focus-within:ring-rose-500">
                        <span class="font-bold">R$</span>
                        <input type="number" name="closing_balance" step="0.01" class="grow font-bold text-xl" placeholder="0.00" required autofocus />
                    </label>
                    <div class="label"><span class="label-text-alt text-gray-400">Conte todo o dinheiro físico.</span></div>
                </div>

                <div class="form-control">
                    <label class="label"><span class="label-text font-medium">Observações</span></label>
                    <textarea name="notes" class="textarea textarea-bordered h-20" placeholder="Justificativa de quebras (se houver)..."></textarea>
                </div>
            </div>

            <div class="p-4 bg-gray-50 border-t flex justify-end gap-2">
                <button type="button" onclick="document.getElementById('modal-backdrop').remove()" class="btn btn-ghost">Cancelar</button>
                <button type="submit" class="btn btn-error text-white shadow-lg shadow-rose-500/30">
                    Encerrar Turno
                </button>
            </div>
        </form>
    </div>
</div>
<script>lucide.createIcons();</script>

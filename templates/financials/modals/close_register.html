<div id="modal-backdrop" class="fixed inset-0 bg-black/50 z-40 flex items-center justify-center p-4">
    <div class="bg-white rounded-xl shadow-2xl w-full max-w-md overflow-hidden relative animate-fade-in">

        <div class="bg-rose-600 p-4 text-white flex justify-between items-center">
            <h3 class="font-bold text-lg flex items-center gap-2">
                <i data-lucide="lock" class="w-5 h-5"></i> Fechamento de Caixa
            </h3>
            <button onclick="document.getElementById('modal-backdrop').remove()" class="btn btn-ghost btn-circle btn-sm text-white">✕</button>
        </div>

        <form hx-post="{% url 'close_register_action' %}"
              hx-target="#modal-backdrop"
              hx-swap="outerHTML">

            <div class="p-6 space-y-4">

                {% if error %}
                <div class="alert alert-error text-sm text-white">
                    <i data-lucide="alert-triangle" class="w-4 h-4"></i>
                    <span>{{ error }}</span>
                </div>
                {% endif %}

                <div class="text-center mb-4">
                    <div class="text-sm text-gray-500">Sessão Iniciada em</div>
                    <div class="font-bold">{{ session.created_at|date:"d/m/Y H:i" }}</div>
                </div>

                <div class="form-control">
                    <label class="label"><span class="label-text font-bold text-rose-600">Quanto tem na gaveta AGORA?</span></label>
                    <label class="input input-bordered input-error flex items-center gap-2">
                        R$
                        <input type="number" name="closing_balance" step="0.01" class="grow font-bold text-rose-600" placeholder="0.00" required autofocus />
                    </label>
                    <div class="label"><span class="label-text-alt">Conte todo o dinheiro físico.</span></div>
                </div>

                <div class="form-control">
                    <label class="label"><span class="label-text">Observações</span></label>
                    <textarea name="notes" class="textarea textarea-bordered" placeholder="Justificativa de quebras (se houver)..."></textarea>
                </div>
            </div>

            <div class="p-4 bg-gray-50 border-t flex justify-end gap-2">
                <button type="button" onclick="document.getElementById('modal-backdrop').remove()" class="btn btn-ghost">Cancelar</button>
                <button type="submit" class="btn btn-error text-white">Encerrar Turno</button>
            </div>
        </form>
    </div>
</div>
<script>lucide.createIcons();</script>

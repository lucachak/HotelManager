{% extends 'base.html' %}

{% block title %}Controle de Estoque | Hotel Lux{% endblock %}

{% block content %}
<div class="max-w-5xl mx-auto">

    <div class="flex justify-between items-center mb-6">
        <div>
            <h2 class="text-3xl font-bold text-gray-800">Controle de Estoque</h2>
            <p class="text-gray-500">Gerencie produtos do frigobar e bar.</p>
        </div>

        <a href="/admin/financials/product/add/" target="_blank" class="btn btn-primary text-white gap-2 shadow-lg shadow-primary/30">
            <i data-lucide="plus" class="w-4 h-4"></i> Novo Produto
        </a>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
        {% for product in products %}

        <div class="card bg-white shadow-sm border border-gray-100 hover:shadow-md transition-all group">
            <div class="card-body p-5">

                <div
                    hx-get="{% url 'product_edit_htmx' product.id %}"
                    hx-target="#booking-modal-container"
                    hx-swap="innerHTML"
                    class="cursor-pointer"
                    title="Clique para editar detalhes">

                    <div class="flex justify-between items-start">
                        <div class="flex-1">
                            <h3 class="font-bold text-gray-800 text-lg group-hover:text-primary transition-colors flex items-center gap-2">
                                {{ product.name }}
                                <i data-lucide="pencil" class="w-3 h-3 opacity-0 group-hover:opacity-100 transition-opacity text-primary"></i>
                            </h3>
                            <p class="text-sm text-gray-500 font-medium mt-1">
                                R$ <span class="text-gray-800 font-bold text-base">{{ product.price }}</span>
                            </p>
                        </div>

                        {% if not product.is_active %}
                            <div class="badge badge-ghost">Inativo</div>
                        {% elif product.stock == 0 %}
                            <div class="badge badge-error text-white font-bold">Esgotado</div>
                        {% elif product.stock < 10 %}
                            <div class="badge badge-warning text-white font-bold">Baixo</div>
                        {% else %}
                            <div class="badge badge-success text-white font-bold">OK</div>
                        {% endif %}
                    </div>

                    <div class="py-4 flex items-center gap-2">
                        <i data-lucide="package" class="w-5 h-5 text-gray-400"></i>
                        <span class="text-3xl font-bold {% if product.stock < 10 %}text-amber-500{% else %}text-gray-700{% endif %}">
                            {{ product.stock }}
                        </span>
                        <span class="text-xs text-gray-400 uppercase font-bold mt-2">Unidades</span>
                    </div>
                </div>

                <div class="card-actions mt-2 pt-4 border-t border-gray-50">
                    <button
                        hx-get="{% url 'restock_product_modal' product.id %}"
                        hx-target="#booking-modal-container"
                        hx-swap="innerHTML"
                        class="btn btn-sm btn-ghost w-full gap-2 hover:bg-gray-100 border border-gray-200">
                        <i data-lucide="archive-restore" class="w-4 h-4 text-gray-500"></i>
                        <span class="text-gray-600">Repor Estoque</span>
                    </button>
                </div>

            </div>
        </div>
        {% endfor %}
    </div>

</div>
{% endblock %}

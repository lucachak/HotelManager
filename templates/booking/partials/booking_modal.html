<div id="booking-modal" class="modal modal-open backdrop-blur-sm">
    <div class="modal-box w-11/12 max-w-2xl bg-base-100 shadow-2xl relative">
        
        <button onclick="closeModal()" class="btn btn-sm btn-circle btn-ghost absolute right-2 top-2">✕</button>
        
        <h3 class="font-bold text-lg text-primary flex items-center gap-2">
            <i data-lucide="calendar-plus"></i> Nova Reserva
        </h3>
        <p class="text-sm text-gray-500 mb-6">Preencha os dados para bloquear o quarto.</p>

        <form hx-post="{% url 'create_booking_htmx' %}" 
              hx-target="#booking-modal-container" 
              hx-swap="innerHTML"
              class="space-y-4">
            
            {% csrf_token %}

            {% if form.non_field_errors %}
            <div class="alert alert-error text-sm shadow-lg rounded-lg">
                <i data-lucide="alert-circle"></i>
                <span>{{ form.non_field_errors.0 }}</span>
            </div>
            {% endif %}

            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div class="form-control">
                    <label class="label"><span class="label-text font-medium">Hóspede</span></label>
                    {{ form.guest }}
                </div>

                <div class="form-control">
                    <label class="label"><span class="label-text font-medium">Quarto</span></label>
                    {{ form.room }}
                </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div class="form-control">
                    <label class="label"><span class="label-text font-medium">Check-in</span></label>
                    {{ form.start_date }}
                </div>

                <div class="form-control">
                    <label class="label"><span class="label-text font-medium">Check-out</span></label>
                    {{ form.end_date }}
                </div>
            </div>

            <div class="modal-action mt-8 border-t border-base-200 pt-4">
                <button type="button" onclick="closeModal()" class="btn btn-ghost">Cancelar</button>
                <button type="submit" class="btn btn-primary text-white shadow-lg shadow-primary/30">
                    <span class="loading loading-spinner loading-xs htmx-indicator"></span>
                    Confirmar Reserva
                </button>
            </div>
        </form>
    </div>
</div>

<script>
    lucide.createIcons();
    
    function closeModal() {
        const container = document.getElementById('booking-modal-container');
        if (container) {
            container.innerHTML = ''; 
        }
        
        const modal = document.getElementById('booking-modal');
        if (modal) {
            modal.remove();
        }
    }
</script>
